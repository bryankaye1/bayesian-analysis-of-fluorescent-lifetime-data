This set of MATLAB codes were used to test Bayesian FLIM-FRET analysis in low-photon regime, presented in “Developing and Testing a Bayesian Analysis of Fluorescence Lifetime Measurements” by Kaye et al.

Master FLIM data: ex850nm_em542_27_035v_10x_int10sec_singlepoint_m1.asc (not included due to large size)

Major codes:
1. RandomSamplingFitTest.m: this code generates FLIM curves composed of N number of photons by randomly sampling photons from the master FLIM data. 300 FLIM curves are sampled for each N, where N takes 11 different numbers from 50 to 10^5. 
Random sampling part has been commented out as the master FLIM data is not included here. 
The sampled FLIM curves were saved in “sampled_decay_counts50to100000_300samples.mat”
The sampled FLIM curves are then analyzed using Bayesian FLIM-FRET approach to evaluate the accuracy and precision. 
The Bayesian analysis setting and results are saved in SavedResult folder (results not included)
2. ErrorAnalysis_300samples_PhotonFraction.m: This code plots the results of random sampling test generated by the code “RandomSamplingFitTest.m”. Run “RandomSamplingFitTest.m” before running this code.


Test result figures: 
1. FractionErr_300samples_BayesOnly_Photon.fig displays FRET photon fraction estimated by Bayesian analysis, averaged over 300 samples, as a function of the number of photons. 
2. FractionErr_300samples_BayesOnly_Photon.fig displays the standard deviation of FRET photon fraction estimated by Bayesian analysis from 300 samples as a function of the number of photons. 



